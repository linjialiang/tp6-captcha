# tp6-captcha

thinkphp6 验证码类库

```text
- 基于 ThinkPHP 6.0.x 编写
- 测试环境为 ThinkPHP 6.0.1
- 必备php扩展 Imagick
```

## 安装

> composer require linjialiang/tp6-captcha

## 使用

### 在控制器中输出验证码

在控制器的操作方法中使用

```
public function captcha($id = '')
{
	return captcha($id);
}
```

然后注册对应的路由来输出验证码

### 模板里输出验证码

首先要在你应用的路由定义文件中，注册一个验证码路由规则。

```
\linjialiang\facade\Route::get('captcha/[:id]', "\\linjialiang\\captcha\\CaptchaController@index");
```

然后就可以在模板文件中使用

```
<div>{:captcha_img()}</div>
```

或者

```
<div><img src="{:captcha_src()}" alt="captcha" /></div>
```

> 上面两种的最终效果是一样的

### 控制器里验证

使用 TP 的内置验证功能即可

```
$this->validate($data,[
    'captcha|验证码'=>'require|captcha'
]);
```

或者手动验证

```
if(!captcha_check($captcha)){
 //验证失败
};
```

## 字符说明

默认字体，支持的字符有限，如需增加其它字符请重新载入字体：

1. 中文字符集

    ```text
    天地玄黄宇宙洪荒日月列张寒来暑往秋收冬闰余成岁律吕调阳云腾致雨结为金生丽水玉出昆冈剑号巨珠称夜光果珍李重姜海咸河淡羽翔龙师火帝鸟官人皇始制文字乃服衣裳推位让国有唐吊民伐罪周发汤坐朝问道垂拱平章爱育首臣伏一体率宾归王鸣凤在竹白食场化被草木赖及万方盖此身发四大五常恭养岂敢伤女贞洁男效才良知过必改得能莫忘谈彼短己长信使可器欲难量丝染诗赞羊景行维贤克念作圣德建名立形端表正空谷传声虚堂习听祸因恶积福缘善庆尺非宝寸阴是资父事君曰严与敬孝当竭力忠则尽命临深兴温凊似兰斯如松之盛川流不息渊取映容止若思言辞安定笃初诚美慎终宜令荣业所基甚无竟学优登仕职从政存以甘去而益乐殊贵礼别尊卑上和下睦夫唱妇随外受入奉母仪诸姑伯叔犹子比儿孔怀兄弟同气连枝交友投分切磨规仁慈造次弗离节义退亏性静情逸心动神疲守真志逐物意移坚持雅操好自都邑华夏东西二京背面浮渭据宫殿盘郁楼观飞惊图写禽兽画彩仙灵丙舍旁启甲帐对设席吹升阶陛转疑星右通广内左达承明既集典亦英杜书经府罗将相路侠户封八县家给千兵高冠陪振世富车驾肥轻策功实碑刻盘溪伊尹时阿宅曲微旦营公匡合济弱扶倾回汉惠说感武丁俊义密勿多士实宁晋楚更赵困横途灭践土会盟何约法韩烦刑起颇牧用军最精宣威沙漠驰誉丹青九州禹迹百郡秦并岳宗泰禅主云亭雁门紫塞鸡田赤诚昆池石野洞庭远绵岩冥治本于农务载南亩我艺税贡新劝赏孟素史鱼秉直庶几中庸劳谦谨音察理色勉其植省躬讥诫宠增抗极近林幸即两疏见机解组谁逼索居闲处沉默求古寻论散逍遥欣奏累谢欢招荷的历园抽条枇杷晚翠陈根委落叶摇游运读玩市目箱易畏属耳墙具饭适口充肠饱饥厌故旧老少异粮绩侍巾房扇圆洁银烛煌昼眠夕蓝笋象床弦歌酒宴接杯举手顿足悦且康后续尝再拜简要答审详想浴执热凉跃超获布射丸琴笔伦纸钧巧任钓纷并皆佳妙毛施姿工妍笑年矢每朗环照指修永吉矩步引领仰庙带庄徘徊闻等语助者乎也
    ```

2. 常规字符集

    ```text
    2345678abcdefhijkmnpqrstuvwxyzABCDEFGHJKLMNPQRTUVWXY
    ```

3. math 字符集

    ```text
    0123456789+-*/%
    ```

## 参考来源

tp6-captcha 灵感来自 [thinkphp 官方验证码类库](https://packagist.org/packages/topthink/think-captcha)，操作上与其基本一致！
